---
id: installation
title: Installation and Update
sidebar_label: Installation
description: Pester is a cross-platform PowerShell module for testing your PowerShell code. Follow these steps to install or update your Pester-module to get started today
---

## Compatibility

Pester is a cross-platform module that runs on Windows, Linux, MacOS and anywhere else supported by PowerShell. It is tested and compatible with:
- Windows PowerShell 3.0 - 5.1
- PowerShell 6.0.4 and above

## Installing from PSGallery

From an PowerShell session run:

```powershell
# For all users (requires "Run as Administrator" on Windows)
Install-Module -Name Pester

# For current user only
Install-Module -Name Pester -Scope CurrentUser
```

Or to update:

```powershell
Update-Module -Name Pester
```

:::note Missing package manager for Windows PowerShell 3 and 4
In Windows PowerShell 3 and 4 there is no default package manager installed, but luckily `PowerShellGet` is available for installation. See detailed [instructions here](https://docs.microsoft.com/en-us/powershell/scripting/gallery/installing-psget#for-computers-running-powershell-30-or-powershell-40). When you have the package manager installed, please start a new PowerShell session and retry the commands above.

Windows 10 / Windows Server 2016 and later includes Windows PowerShell 5.1 out-of-the-box and are not affected.
:::

:::note Possible TLS error while connecting to PSGallery
If you receive the following warning when trying to install the module, you may need to explicitly enable TLS 1.2:

```powershell
WARNING: Unable to resolve package source 'https://www.powershellgallery.com/api/v2'.
```

To enable TLS 1.2 for the current PowerShell instance, you can run the following code, and then re-run the installation command:

```powershell
[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor [System.Net.SecurityProtocolType]::Tls12
```
:::

## Special instructions for Windows 10 and Windows Server 2016

Pester version 3.4.0 shipped as part of Windows 10 and Windows Server 2016. While it raised awareness about testing PowerShell code, it unfortunately brought some distribution conflicts with it. As a result, it is not possible to directly update the built-in Pester to a newer version using the `Update-Module` cmdlet.

Instead you need to perform a new side-by-side installation of Pester, because `Install-Module` detects the current installation of Pester is signed by Microsoft which is not the case for later versions which are community maintained and signed with a different certificate.

You can resolve this by running the following command in a PowerShell-instance _as administrator_:

```powershell
Install-Module -Name Pester -Force -SkipPublisherCheck
```

### Removing the Built-In Version of Pester

If you need to remove the built-in version of Pester on your machine, you can do so by executing the following code:

```powershell
$module = "C:\Program Files\WindowsPowerShell\Modules\Pester"
takeown /F $module /A /R
icacls $module /reset
icacls $module /grant "*S-1-5-32-544:F" /inheritance:d /T
Remove-Item -Path $module -Recurse -Force -Confirm:$false

Install-Module -Name Pester -Force
```

For any subsequent update it is enough to run:

```powershell
Update-Module -Name Pester
```

## Installing manually

You don't have to use a package manager to install Pester. Another option is to download and installating it manually which can be useful in e.g. offline envionments.

1. Download the module on a machine with internet using either:
    - **Recommended:** `Save-Module -Name Pester -Path C:\Temp`. It will save it in a versioned folder, ex *C:\Temp\Pester\5.5.0*
    - Or download the NuGet package from PowerShell Gallery and extract it, see [Manual Package Download](https://docs.microsoft.com/en-us/powershell/scripting/gallery/how-to/working-with-packages/manual-download)
2. Copy the Pester-folder (ex. C:\Temp\Pester) to your destination computer and place it in one of your module directories defined by [$env:PSModulePath](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_psmodulepath). On a Windows-system it will by default include:
    - *$HOME\Documents\WindowsPowerShell\Modules*
    - *$env:ProgramFiles\WindowsPowerShell\Modules*
    - *$env:SystemRoot\system32\WindowsPowerShell\v1.0\Modules*
3. Start PowerShell and start testing.

:::tip
Step 2 is an optional step to enable simple import by name and module auto-loading. You could also import Pester using an absolute path like `Import-Module C:\Temp\Pester\5.5.0`.
:::

## Alternative package sources

PSGallery is the easiest way to get Pester installed to your computer, but there are alternatives.
On a build server you might prefer using [Chocolatey](https://chocolatey.org/), or if you're adding Pester to your .NET project that already uses [NuGet](https://www.nuget.org/) you might prefer that.

These options may not support pre-release versions and it may need to be initialized on first use.

### Chocolatey

[Chocolatey](https://chocolatey.org/) (or _choco_) is a commonly used package manager for Windows. You can install Pester using:

```powershell
choco install Pester
```

Or to update:

```powershell
choco upgrade Pester
```

You may also pass the `--prerelease` option to install or update to a prerelease version of Pester.

### Nuget

[Nuget](https://www.nuget.org/) is the package manager for .NET projects.
Getting Pester from Nuget is useful when you are integrating PowerShell code with your .NET project, and want to have that code tested.

To install use Package Manager of Visual Studio, or Package Manager Console in Visual Studio.
Once you need this we are pretty sure you know what you are doing. :slightly_smiling_face:
